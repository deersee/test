<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸æˆç®¡ç†åå° - Game8.live</title>
    <meta name="description" content="Game8.live æ¸¸æˆç®¡ç†åå°ç³»ç»Ÿ">
    <meta name="author" content="Game8.live">
    
    <link rel="stylesheet" href="styles.css">
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .admin-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .admin-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        
        .admin-nav {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }
        
        .admin-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .admin-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .form-array {
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 15px;
            background: #f8f9fa;
        }
        
        .array-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .array-item:last-child {
            margin-bottom: 0;
        }
        
        .array-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        .array-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .array-btn:hover {
            background: #ee5a24;
        }
        
        .add-array-btn {
            background: #4ecdc4;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .add-array-btn:hover {
            background: #45b7d1;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .games-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .game-item {
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .game-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .game-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .game-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }
        
        .game-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .edit-btn {
            background: #4ecdc4;
            color: white;
        }
        
        .edit-btn:hover {
            background: #45b7d1;
        }
        
        .delete-btn {
            background: #ff6b6b;
            color: white;
        }
        
        .delete-btn:hover {
            background: #ee5a24;
        }
        
        .game-info {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .game-stats {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            font-size: 0.8rem;
            color: #888;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .admin-content {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .admin-nav {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <a href="index.html" class="back-link">
            â† è¿”å›é¦–é¡µ
        </a>
        
        <div class="admin-header">
            <h1 class="admin-title">
                ğŸ® æ¸¸æˆç®¡ç†åå°
            </h1>
            <p class="admin-subtitle">ç®¡ç† Game8.live çš„æ‰€æœ‰æ¸¸æˆå†…å®¹å’Œæ•°æ®</p>
            
            <div class="admin-nav">
                <button class="nav-btn active" onclick="showPanel('add')">æ·»åŠ æ¸¸æˆ</button>
                <button class="nav-btn" onclick="showPanel('manage')">ç®¡ç†æ¸¸æˆ</button>
                <button class="nav-btn" onclick="showPanel('stats')">æ•°æ®ç»Ÿè®¡</button>
                <button class="nav-btn" onclick="showPanel('users')">ç”¨æˆ·ç®¡ç†</button>
            </div>
        </div>
        
        <div class="admin-content">
            <!-- æ·»åŠ æ¸¸æˆé¢æ¿ -->
            <div id="add-panel" class="admin-panel">
                <h2 class="panel-title">â• æ·»åŠ æ–°æ¸¸æˆ</h2>
                
                <div id="message-container"></div>
                
                <form id="game-form">
                    <div class="form-group">
                        <label class="form-label">æ¸¸æˆID *</label>
                        <input type="text" id="game-id" class="form-input" placeholder="ä¾‹å¦‚: newgame" required>
                        <small style="color: #666; font-size: 0.9rem;">ç”¨äºURLå’Œå†…éƒ¨æ ‡è¯†ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">æ¸¸æˆåç§° *</label>
                        <input type="text" id="game-title" class="form-input" placeholder="ä¾‹å¦‚: æ–°æ¸¸æˆ" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">æ¸¸æˆæè¿° *</label>
                        <textarea id="game-description" class="form-textarea" placeholder="è¯¦ç»†æè¿°æ¸¸æˆç©æ³•å’Œç‰¹è‰²..." required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">æ¸¸æˆåˆ†ç±» *</label>
                            <select id="game-category" class="form-select" required>
                                <option value="">é€‰æ‹©åˆ†ç±»</option>
                                <option value="action">åŠ¨ä½œæ¸¸æˆ</option>
                                <option value="strategy">ç­–ç•¥æ¸¸æˆ</option>
                                <option value="puzzle">ç›Šæ™ºæ¸¸æˆ</option>
                                <option value="racing">ç«é€Ÿæ¸¸æˆ</option>
                                <option value="sports">ä½“è‚²æ¸¸æˆ</option>
                                <option value="social">ç¤¾äº¤æ¸¸æˆ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">æ¸¸æˆå›¾ç‰‡URL *</label>
                            <input type="url" id="game-image" class="form-input" placeholder="https://images.unsplash.com/..." required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">æ¸¸æˆé“¾æ¥ *</label>
                        <input type="url" id="game-iframe" class="form-input" placeholder="https://example.com/game" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">æ¸¸æˆæ ‡ç­¾</label>
                        <div class="form-array" id="tags-container">
                            <div class="array-item">
                                <input type="text" class="array-input" placeholder="æ ‡ç­¾1">
                                <button type="button" class="array-btn" onclick="removeArrayItem(this)">åˆ é™¤</button>
                            </div>
                        </div>
                        <button type="button" class="add-array-btn" onclick="addArrayItem('tags-container', 'æ ‡ç­¾')">æ·»åŠ æ ‡ç­¾</button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">æ“ä½œè¯´æ˜</label>
                        <div class="form-array" id="controls-container">
                            <div class="array-item">
                                <input type="text" class="array-input" placeholder="æ“ä½œè¯´æ˜1">
                                <button type="button" class="array-btn" onclick="removeArrayItem(this)">åˆ é™¤</button>
                            </div>
                        </div>
                        <button type="button" class="add-array-btn" onclick="addArrayItem('controls-container', 'æ“ä½œè¯´æ˜')">æ·»åŠ æ“ä½œè¯´æ˜</button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">æ¸¸æˆæŠ€å·§</label>
                        <div class="form-array" id="tips-container">
                            <div class="array-item">
                                <input type="text" class="array-input" placeholder="æ¸¸æˆæŠ€å·§1">
                                <button type="button" class="array-btn" onclick="removeArrayItem(this)">åˆ é™¤</button>
                            </div>
                        </div>
                        <button type="button" class="add-array-btn" onclick="addArrayItem('tips-container', 'æ¸¸æˆæŠ€å·§')">æ·»åŠ æ¸¸æˆæŠ€å·§</button>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">æ¸¸ç©æ¬¡æ•°</label>
                            <input type="number" id="play-count" class="form-input" placeholder="100000" min="0">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å–œçˆ±åº¦</label>
                            <input type="number" id="likes" class="form-input" placeholder="5000" min="0">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">è¯„åˆ† (1-5)</label>
                            <input type="number" id="rating" class="form-input" placeholder="4.5" min="1" max="5" step="0.1">
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn">æ·»åŠ æ¸¸æˆ</button>
                </form>
            </div>
            
            <!-- ç®¡ç†æ¸¸æˆé¢æ¿ -->
            <div id="manage-panel" class="admin-panel" style="display: none;">
                <h2 class="panel-title">ğŸ“‹ æ¸¸æˆåˆ—è¡¨ç®¡ç†</h2>
                <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px;">
                    <input type="text" id="game-search" class="form-input" placeholder="æœç´¢æ¸¸æˆåç§°ã€IDæˆ–æ ‡ç­¾..." style="flex: 1;">
                    <div style="white-space: nowrap; color: #666;">
                        <span>æ€»æ•°ï¼š</span><strong id="count-total">0</strong>
                        <span style="margin: 0 8px;">|</span>
                        <span>åŒ¹é…ï¼š</span><strong id="count-filtered">0</strong>
                    </div>
                </div>
                <div class="games-list" id="games-list">
                    <!-- æ¸¸æˆåˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- æ•°æ®ç»Ÿè®¡é¢æ¿ -->
            <div id="stats-panel" class="admin-panel" style="display: none;">
                <h2 class="panel-title">ğŸ“Š æ•°æ®ç»Ÿè®¡</h2>
                
                <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="total-games">0</h3>
                        <p>æ€»æ¸¸æˆæ•°</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="total-plays">0</h3>
                        <p>æ€»æ¸¸ç©æ¬¡æ•°</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="total-likes">0</h3>
                        <p>æ€»å–œçˆ±åº¦</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #96ceb4 0%, #feca57 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="avg-rating">0</h3>
                        <p>å¹³å‡è¯„åˆ†</p>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">åˆ†ç±»ç»Ÿè®¡</h3>
                    <div id="category-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <!-- åˆ†ç±»ç»Ÿè®¡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <!-- ç”¨æˆ·ç®¡ç†é¢æ¿ -->
            <div id="users-panel" class="admin-panel" style="display: none;">
                <h2 class="panel-title">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <!-- æ·»åŠ ç”¨æˆ·è¡¨å• -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: #333;">æ·»åŠ æ–°ç®¡ç†å‘˜</h3>
                        
                        <div id="user-message-container"></div>
                        
                        <form id="user-form">
                            <div class="form-group">
                                <label class="form-label">ç”¨æˆ·å *</label>
                                <input type="text" id="new-username" class="form-input" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">å¯†ç  *</label>
                                <input type="password" id="new-password" class="form-input" placeholder="è¯·è¾“å…¥å¯†ç " required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">ç¡®è®¤å¯†ç  *</label>
                                <input type="password" id="confirm-password" class="form-input" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç " required>
                            </div>
                            
                            <button type="submit" class="submit-btn">æ·»åŠ ç®¡ç†å‘˜</button>
                        </form>
                    </div>
                    
                    <!-- ç”¨æˆ·åˆ—è¡¨ -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: #333;">ç®¡ç†å‘˜åˆ—è¡¨</h3>
                        
                        <div class="games-list" id="users-list" style="max-height: 400px;">
                            <!-- ç”¨æˆ·åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®ç®¡ç†
        let gamesData = {};
        // å½“å‰ç¼–è¾‘ä¸­çš„æ¸¸æˆIDï¼Œnull è¡¨ç¤ºæ·»åŠ æ¨¡å¼
        let currentEditingId = null;
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkLoginStatus()) {
                window.location.href = 'admin-login.html';
                return;
            }
            
            loadGamesData();
            loadGamesList();
            initGameSearch();
            updateStats();
            
            // è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('game-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addGame();
            });
            
            // ç”¨æˆ·è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('user-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addUser();
            });
            
            // æ·»åŠ ç™»å‡ºåŠŸèƒ½
            addLogoutButton();
        });

        // åˆå§‹åŒ–æœç´¢ï¼ˆå¸¦é˜²æŠ–ï¼‰
        function initGameSearch() {
            const input = document.getElementById('game-search');
            if (!input) return;
            let timer = null;
            const handler = () => {
                const q = input.value || '';
                loadGamesList(q);
            };
            input.addEventListener('input', () => {
                clearTimeout(timer);
                timer = setTimeout(handler, 200);
            });
        }
        
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const loginData = localStorage.getItem('adminLoginData');
            if (!loginData) {
                return false;
            }
            
            try {
                const data = JSON.parse(loginData);
                if (!data.isLoggedIn || data.expires <= Date.now()) {
                    // ç™»å½•å·²è¿‡æœŸæˆ–æ— æ•ˆ
                    localStorage.removeItem('adminLoginData');
                    return false;
                }
                return true;
            } catch (error) {
                localStorage.removeItem('adminLoginData');
                return false;
            }
        }
        
        // æ·»åŠ ç™»å‡ºæŒ‰é’®
        function addLogoutButton() {
            const adminNav = document.querySelector('.admin-nav');
            const logoutBtn = document.createElement('button');
            logoutBtn.className = 'nav-btn';
            logoutBtn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)';
            logoutBtn.innerHTML = 'ğŸšª ç™»å‡º';
            logoutBtn.onclick = function() {
                if (confirm('ç¡®å®šè¦ç™»å‡ºå—ï¼Ÿ')) {
                    localStorage.removeItem('adminLoginData');
                    window.location.href = 'admin-login.html';
                }
            };
            adminNav.appendChild(logoutBtn);
        }
        
        // åŠ è½½æ¸¸æˆæ•°æ®
        function loadGamesData() {
            // å®šä¹‰2025é»˜è®¤æ¸¸æˆæ•°æ®
            const defaultGames2025 = {
                    smashkarts: {
                        title: 'Smash Karts',
                        description: 'å¤šäººå®æ—¶å¡ä¸è½¦å¯¹æˆ˜ï¼Œæ‹¾å–é“å…·å¹¶å‡»è´¥å¯¹æ‰‹ï¼Œå‡­æŠ€å·§ä¸è¿æ°”ç§°ç‹ã€‚',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1502877338535-766e1452684a?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://smashkarts.io/',
                        tags: ['å¤šäºº', 'é“å…·', 'å¯¹æˆ˜'],
                        controls: ['WASDé©¾é©¶ï¼Œç©ºæ ¼æ¼‚ç§»ï¼Œé¼ æ ‡ä½¿ç”¨é“å…·'],
                        tips: ['å¼¯é“å‰é¢„æ¼‚ç§»', 'é“å…·ç•™ç»™å…³é”®ä½', 'è´´å†…çº¿èµ°ä½'],
                        stats: { playCount: 520000, likes: 46000, rating: 4.4 }
                    },
                    diep: {
                        title: 'Diep.io',
                        description: 'è¿›åŒ–ä½ çš„æˆ˜è½¦ï¼Œåˆ·æ€ªä¸å¯¹æˆ˜å…¼å…·çš„å¦å…‹å°„å‡»ã€‚',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1510798831971-661eb04b3739?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://diep.io/',
                        tags: ['å°„å‡»', 'è¿›åŒ–', 'å¯¹æˆ˜'],
                        controls: ['WASDç§»åŠ¨ï¼Œé¼ æ ‡å°„å‡»ï¼ŒEå‡çº§'],
                        tips: ['å…ˆå †ç”Ÿå­˜ä¸è¾“å‡º', 'ä¸­æœŸé€‰å¥½åˆ†æ”¯', 'ç•™æ„é«˜åˆ†ç©å®¶'],
                        stats: { playCount: 780000, likes: 69000, rating: 4.3 }
                    },
                    starblast: {
                        title: 'Starblast.io',
                        description: 'å¤ªç©ºé‡‡çŸ¿ä¸èˆ°èˆ¹æˆ˜æ–—ï¼Œå‡çº§é£èˆ¹å¹¶å‚ä¸é˜µè¥æˆ˜äº‰ã€‚',
                        category: 'strategy',
                        image: 'https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://starblast.io/',
                        tags: ['å¤ªç©º', 'é‡‡çŸ¿', 'æˆ˜æ–—'],
                        controls: ['WASD/æ–¹å‘é”®é£è¡Œï¼Œé¼ æ ‡å°„å‡»'],
                        tips: ['å‰æœŸé‡‡çŸ¿ç¨³å¥å‡çº§', 'æŠ±å›¢ä½œæˆ˜æ”¶ç›Šé«˜', 'è¿½å‡»åˆ«è¶Šç•Œ'],
                        stats: { playCount: 430000, likes: 36000, rating: 4.2 }
                    },
                    mope: {
                        title: 'Mope.io',
                        description: 'ä»å°ç”Ÿç‰©è¿›åŒ–åˆ°é¡¶çº§æ•é£Ÿè€…ï¼Œé£Ÿç‰©é“¾ä¸Šçš„ç”Ÿå­˜ä¹‹æˆ˜ã€‚',
                        category: 'adventure',
                        image: 'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://mope.io/',
                        tags: ['è¿›åŒ–', 'ç”Ÿå­˜', 'æ²™ç›’'],
                        controls: ['é¼ æ ‡ç§»åŠ¨ï¼Œç‚¹å‡»å†²åˆº'],
                        tips: ['åŒè‰²å®‰å…¨ï¼Œä¸åŒè‰²è°¨æ…', 'åˆ©ç”¨åœ°å½¢', 'åˆç†è¿›åŒ–è·¯çº¿'],
                        stats: { playCount: 390000, likes: 31000, rating: 4.1 }
                    },
                    taming: {
                        title: 'Taming.io',
                        description: 'é©¯æœå® ç‰©ã€å»ºé€ ä¸ç”Ÿå­˜çš„åƒç´ é£æ²™ç›’å¯¹æˆ˜ã€‚',
                        category: 'strategy',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://taming.io/',
                        tags: ['æ²™ç›’', 'å»ºé€ ', 'å® ç‰©'],
                        controls: ['WASDç§»åŠ¨ï¼Œé¼ æ ‡æ“ä½œï¼Œæ•°å­—é”®åˆ‡æ¢'],
                        tips: ['å…ˆé‡‡é›†å»ºé˜²å¾¡', 'æ•æ‰å…‹åˆ¶ç³»å® ç‰©', 'ç»“ç›Ÿæ•ˆç‡é«˜'],
                        stats: { playCount: 270000, likes: 22000, rating: 4.0 }
                    },
                    lolshot: {
                        title: 'LOLShot.io',
                        description: 'å¿«èŠ‚å¥å¡é€šFPSï¼Œå¤šæ¨¡å¼å¯¹æˆ˜ä¸æµç•…æ‰‹æ„Ÿã€‚',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://lolshot.io/',
                        tags: ['FPS', 'å¤šäºº', 'å¿«èŠ‚å¥'],
                        controls: ['WASDç§»åŠ¨ï¼Œé¼ æ ‡å°„å‡»ï¼ŒRè£…å¼¹'],
                        tips: ['å­¦ä¼šä¾§èº«å³°å€¼å°„å‡»', 'æ§ç‚¹æ¯”ç›²å†²æ›´é‡è¦', 'å–„ç”¨è·³å°'],
                        stats: { playCount: 310000, likes: 25000, rating: 4.1 }
                    },
                    hexar: {
                        title: 'Hexar.io',
                        description: 'å…­è¾¹å½¢é¢†åœ°äº‰å¤ºï¼Œå›´çº¿å°åŒºå¹¶æ‰©å¤§åŠ¿åŠ›èŒƒå›´ã€‚',
                        category: 'strategy',
                        image: 'https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://hexar.io/',
                        tags: ['é¢†åœ°', 'å›´çº¿', 'å¯¹æˆ˜'],
                        controls: ['é¼ æ ‡/è§¦æ§ç§»åŠ¨'],
                        tips: ['å°åœˆå¿«å°å£', 'å¡å¯¹æ‰‹å›çº¿', 'ä¼˜å…ˆç¨³å®‰å…¨è¾¹'],
                        stats: { playCount: 260000, likes: 21000, rating: 4.0 }
                    },
                    powerline: {
                        title: 'Powerline.io',
                        description: 'éœ“è™¹è´ªåƒè›‡å¯¹æˆ˜ï¼ŒåŠ é€Ÿä¸å¡ä½çš„é«˜èƒ½åšå¼ˆã€‚',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://powerline.io/',
                        tags: ['è´ªåƒè›‡', 'å¯¹æˆ˜', 'è¡—æœº'],
                        controls: ['æ–¹å‘é”®/WASDç§»åŠ¨'],
                        tips: ['è¾¹çº¿å¡ä½', 'åŠ é€Ÿè¯±æ•Œ', 'ç¨³å¥åƒæ®‹éª¸'],
                        stats: { playCount: 300000, likes: 24000, rating: 4.1 }
                    },
                    evio: {
                        title: 'ev.io',
                        description: 'ç§‘å¹»é£æµè§ˆå™¨FPSï¼Œè½»é‡æµç•…çš„ç«æŠ€ä½“éªŒã€‚',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://ev.io/',
                        tags: ['FPS', 'ç§‘å¹»', 'ç«æŠ€'],
                        controls: ['WASDç§»åŠ¨ï¼Œé¼ æ ‡å°„å‡»ï¼Œç©ºæ ¼è·³è·ƒ'],
                        tips: ['åˆ©ç”¨è·³æ¿æŠ„è¿‘è·¯', 'è¿œè¿‘æªæ¢°åˆ‡æ¢', 'æ§é«˜ç‚¹ä¼˜åŠ¿'],
                        stats: { playCount: 410000, likes: 35000, rating: 4.2 }
                    },
                    smasharena: {
                        title: 'Smash Arena',
                        description: 'ä¸Šå¸è§†è§’çš„ç«æŠ€æ··æˆ˜ï¼Œæ‹¾å–æ­¦å™¨ä¸æŠ€èƒ½å¿«é€Ÿå†³æ–—ã€‚',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://smasharena.io/',
                        tags: ['å¤šäºº', 'ç«æŠ€', 'é“å…·'],
                        controls: ['WASDç§»åŠ¨ï¼Œé¼ æ ‡ç„å‡†/æ–½æ”¾'],
                        tips: ['å…ˆæ´»å†åˆš', 'è§‚å¯Ÿåœˆè¾¹åˆ·æ–°', 'æŠ€èƒ½è¿æ®µè‡´èƒœ'],
                        stats: { playCount: 180000, likes: 15000, rating: 4.0 }
                    },
                    mgsdelta: {
                        title: 'Metal Gear Solid Delta: Snake Eater',
                        description: 'æ½œå…¥ä¸ç”Ÿå­˜ä¸ºæ ¸å¿ƒçš„ç»å…¸é‡åˆ¶ç‰ˆå†…å®¹èšåˆï¼šå®Œæ•´æµç¨‹ã€Boss æŒ‡å—ã€æ­¦å™¨ä¸ä¼ªè£…ã€æ”¶é›†è¦ç´ åŠäº’åŠ¨åœ°å›¾ã€‚',
                        category: 'adventure',
                        image: 'https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://game8.co/games/Metal-Gear-Solid-Delta-Snake-Eater',
                        tags: ['æ½œå…¥', 'åŠ¨ä½œå†’é™©', 'é‡åˆ¶ç‰ˆ', 'æ”»ç•¥'],
                        controls: ['æŒ‰å¹³å°é”®é¼ /æ‰‹æŸ„æ“ä½œï¼›ä»¥æ½œå…¥ä¸CQCä¸ºæ ¸å¿ƒ'],
                        tips: ['ä¼˜å…ˆæ½œè¡Œé™è­¦æˆ’', 'çµæ´»æ›´æ¢ä¼ªè£…', 'Bossæˆ˜å‰è¡¥ç»™ä¸å­˜æ¡£', 'å–„ç”¨äº’åŠ¨åœ°å›¾ä¸æ”¶é›†æ¸…å•'],
                        stats: { playCount: 120000, likes: 9000, rating: 4.6 }
                    }
                };

            // ä»localStorageåŠ è½½æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æˆ–è¿‡å°‘åˆ™ä½¿ç”¨é»˜è®¤æ•°æ®
            const savedData = localStorage.getItem('adminGamesData');
            if (savedData) {
                try {
                    const parsed = JSON.parse(savedData);
                    const count = parsed && typeof parsed === 'object' ? Object.keys(parsed).length : 0;
                    if (count >= 10) {
                        gamesData = parsed;
                    } else {
                        gamesData = defaultGames2025;
                        saveGamesData();
                    }
                } catch (e) {
                    gamesData = defaultGames2025;
                    saveGamesData();
                }
            } else {
                gamesData = defaultGames2025;
                saveGamesData();
            }
        }
        
        // ä¿å­˜æ¸¸æˆæ•°æ®
        function saveGamesData() {
            localStorage.setItem('adminGamesData', JSON.stringify(gamesData));
        }
        
        // æ˜¾ç¤ºé¢æ¿
        function showPanel(panelName) {
            // éšè—æ‰€æœ‰é¢æ¿
            document.querySelectorAll('.admin-panel').forEach(panel => {
                panel.style.display = 'none';
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„é¢æ¿
            document.getElementById(panelName + '-panel').style.display = 'block';
            
            // æ·»åŠ activeç±»åˆ°å¯¹åº”æŒ‰é’®
            event.target.classList.add('active');
            
            // å¦‚æœæ˜¯ç®¡ç†é¢æ¿ï¼Œé‡æ–°åŠ è½½æ¸¸æˆåˆ—è¡¨
            if (panelName === 'manage') {
                loadGamesList();
            }
            
            // å¦‚æœæ˜¯ç»Ÿè®¡é¢æ¿ï¼Œæ›´æ–°ç»Ÿè®¡æ•°æ®
            if (panelName === 'stats') {
                updateStats();
            }
            
            // å¦‚æœæ˜¯ç”¨æˆ·ç®¡ç†é¢æ¿ï¼ŒåŠ è½½ç”¨æˆ·åˆ—è¡¨
            if (panelName === 'users') {
                loadUsersList();
            }

            // è‹¥è¿›å…¥æ·»åŠ é¢æ¿ä¸”éä»ç¼–è¾‘æŒ‰é’®è§¦å‘ï¼Œé€€å‡ºç¼–è¾‘æ¨¡å¼ï¼ˆä¿ç•™è¡¨å•å†…å®¹ï¼‰
            if (panelName === 'add') {
                try {
                    const trigger = event && event.target;
                    if (!trigger || !trigger.classList || !trigger.classList.contains('edit-btn')) {
                        exitEditMode(false);
                    }
                } catch (_) {
                    exitEditMode(false);
                }
            }
        }

        // è¿›å…¥ç¼–è¾‘æ¨¡å¼
        function enterEditMode(gameId) {
            currentEditingId = gameId;
            const submitBtn = document.querySelector('#game-form .submit-btn');
            if (submitBtn) submitBtn.textContent = 'ä¿å­˜ä¿®æ”¹';
        }

        // é€€å‡ºç¼–è¾‘æ¨¡å¼
        function exitEditMode(clearForm = true) {
            currentEditingId = null;
            const submitBtn = document.querySelector('#game-form .submit-btn');
            if (submitBtn) submitBtn.textContent = 'æ·»åŠ æ¸¸æˆ';
            if (clearForm) {
                document.getElementById('game-form').reset();
                resetArrayContainer('tags-container');
                resetArrayContainer('controls-container');
                resetArrayContainer('tips-container');
            }
        }
        
        // æ·»åŠ æˆ–ä¿å­˜æ¸¸æˆ
        function addGame() {
            const gameId = document.getElementById('game-id').value.trim();
            const title = document.getElementById('game-title').value.trim();
            const description = document.getElementById('game-description').value.trim();
            const category = document.getElementById('game-category').value;
            const image = document.getElementById('game-image').value.trim();
            const iframe = document.getElementById('game-iframe').value.trim();
            
            // éªŒè¯å¿…å¡«å­—æ®µ
            if (!gameId || !title || !description || !category || !image || !iframe) {
                showMessage('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                return;
            }
            
            // éªŒè¯æ¸¸æˆIDæ ¼å¼
            if (!/^[a-zA-Z0-9_]+$/.test(gameId)) {
                showMessage('æ¸¸æˆIDåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿', 'error');
                return;
            }
            
            // æ–°å»º/ç¼–è¾‘æ ¡éªŒ
            if (currentEditingId === null) {
                if (gamesData[gameId]) {
                    showMessage('æ¸¸æˆIDå·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–ID', 'error');
                    return;
                }
            } else {
                if (gameId !== currentEditingId && gamesData[gameId]) {
                    showMessage('æ–°çš„æ¸¸æˆIDå·²å­˜åœ¨ï¼Œè¯·æ›´æ¢IDæˆ–ä¿æŒä¸å˜', 'error');
                    return;
                }
            }
            
            // æ”¶é›†æ•°ç»„æ•°æ®
            const tags = getArrayData('tags-container');
            const controls = getArrayData('controls-container');
            const tips = getArrayData('tips-container');
            
            // è·å–ç»Ÿè®¡æ•°æ®
            const playCount = parseInt(document.getElementById('play-count').value) || 0;
            const likes = parseInt(document.getElementById('likes').value) || 0;
            const rating = parseFloat(document.getElementById('rating').value) || 4.0;
            
            // åˆ›å»ºæ¸¸æˆå¯¹è±¡
            const newGame = {
                title: title,
                description: description,
                category: category,
                image: image,
                iframe: iframe,
                tags: tags,
                controls: controls,
                tips: tips,
                stats: {
                    playCount: playCount,
                    likes: likes,
                    rating: rating
                }
            };
            
            // å†™å…¥åˆ°æ¸¸æˆæ•°æ®
            if (currentEditingId === null) {
                gamesData[gameId] = newGame;
            } else {
                if (gameId !== currentEditingId) {
                    delete gamesData[currentEditingId];
                }
                gamesData[gameId] = newGame;
            }
            saveGamesData();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showMessage(currentEditingId === null ? 'æ¸¸æˆæ·»åŠ æˆåŠŸï¼' : 'ä¿å­˜ä¿®æ”¹æˆåŠŸï¼', 'success');
            
            // æ¸…ç©ºè¡¨å•å¹¶é€€å‡ºç¼–è¾‘æ¨¡å¼
            document.getElementById('game-form').reset();
            exitEditMode();
            
            // é‡ç½®æ•°ç»„å®¹å™¨
            resetArrayContainer('tags-container');
            resetArrayContainer('controls-container');
            resetArrayContainer('tips-container');
            loadGamesList();
        }
        
        // è·å–æ•°ç»„æ•°æ®
        function getArrayData(containerId) {
            const container = document.getElementById(containerId);
            const inputs = container.querySelectorAll('.array-input');
            const data = [];
            
            inputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    data.push(value);
                }
            });
            
            return data;
        }
        
        // æ·»åŠ æ•°ç»„é¡¹
        function addArrayItem(containerId, placeholder) {
            const container = document.getElementById(containerId);
            const newItem = document.createElement('div');
            newItem.className = 'array-item';
            newItem.innerHTML = `
                <input type="text" class="array-input" placeholder="${placeholder}">
                <button type="button" class="array-btn" onclick="removeArrayItem(this)">åˆ é™¤</button>
            `;
            container.appendChild(newItem);
        }
        
        // åˆ é™¤æ•°ç»„é¡¹
        function removeArrayItem(button) {
            const container = button.parentElement.parentElement;
            const items = container.querySelectorAll('.array-item');
            
            // è‡³å°‘ä¿ç•™ä¸€ä¸ªé¡¹ç›®
            if (items.length > 1) {
                button.parentElement.remove();
            }
        }
        
        // é‡ç½®æ•°ç»„å®¹å™¨
        function resetArrayContainer(containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="array-item">
                    <input type="text" class="array-input" placeholder="æ ‡ç­¾1">
                    <button type="button" class="array-btn" onclick="removeArrayItem(this)">åˆ é™¤</button>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, type) {
            const container = document.getElementById('message-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            
            container.innerHTML = '';
            container.appendChild(messageDiv);
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
        
        // åŠ è½½æ¸¸æˆåˆ—è¡¨
        function loadGamesList(filter = '') {
            const container = document.getElementById('games-list');
            const totalEl = document.getElementById('count-total');
            const filteredEl = document.getElementById('count-filtered');
            container.innerHTML = '';

            const allIds = Object.keys(gamesData);
            const norm = (s) => (s || '').toString().toLowerCase();
            const q = norm(filter);
            const filteredIds = allIds.filter(id => {
                if (!q) return true;
                const g = gamesData[id];
                return (
                    norm(id).includes(q) ||
                    norm(g.title).includes(q) ||
                    norm(g.category).includes(q) ||
                    (g.tags || []).some(t => norm(t).includes(q))
                );
            });

            filteredIds.forEach(gameId => {
                const game = gamesData[gameId];
                const gameItem = document.createElement('div');
                gameItem.className = 'game-item';
                gameItem.style.display = 'grid';
                gameItem.style.gridTemplateColumns = '120px 1fr auto';
                gameItem.style.gap = '15px';

                const thumb = document.createElement('div');
                thumb.style.width = '120px';
                thumb.style.height = '80px';
                thumb.style.overflow = 'hidden';
                thumb.style.borderRadius = '10px';
                thumb.innerHTML = `<img src="${game.image || ''}" alt="${game.title}" style="width:100%;height:100%;object-fit:cover;">`;

                const info = document.createElement('div');
                info.innerHTML = `
                    <div class="game-header" style="margin-bottom: 6px;">
                        <h3 class="game-title" style="margin:0;">${game.title}</h3>
                    </div>
                    <div class="game-info">
                        <p><strong>ID:</strong> ${gameId}ã€€<strong>åˆ†ç±»:</strong> ${game.category}</p>
                        <p style="margin-top:4px;color:#666;">${game.description.substring(0, 120)}${game.description.length > 120 ? '...' : ''}</p>
                        <div class="game-stats" style="margin-top:8px;">
                            <div class="stat-item"><span>ğŸ®</span><span>${formatNumber(game.stats.playCount)}æ¬¡</span></div>
                            <div class="stat-item"><span>â¤ï¸</span><span>${formatNumber(game.stats.likes)}</span></div>
                            <div class="stat-item"><span>â­</span><span>${game.stats.rating}</span></div>
                        </div>
                    </div>
                `;

                const actions = document.createElement('div');
                actions.className = 'game-actions';
                actions.innerHTML = `
                    <button class="action-btn edit-btn" onclick="editGame('${gameId}')">ç¼–è¾‘</button>
                    <button class="action-btn delete-btn" onclick="deleteGame('${gameId}')">åˆ é™¤</button>
                `;

                gameItem.appendChild(thumb);
                gameItem.appendChild(info);
                gameItem.appendChild(actions);
                container.appendChild(gameItem);
            });

            if (totalEl) totalEl.textContent = allIds.length;
            if (filteredEl) filteredEl.textContent = filteredIds.length;
        }
        
        // ç¼–è¾‘æ¸¸æˆ
        function editGame(gameId) {
            const game = gamesData[gameId];
            
            // å¡«å……è¡¨å•
            document.getElementById('game-id').value = gameId;
            document.getElementById('game-title').value = game.title;
            document.getElementById('game-description').value = game.description;
            document.getElementById('game-category').value = game.category;
            document.getElementById('game-image').value = game.image;
            document.getElementById('game-iframe').value = game.iframe;
            document.getElementById('play-count').value = game.stats.playCount;
            document.getElementById('likes').value = game.stats.likes;
            document.getElementById('rating').value = game.stats.rating;
            
            // å¡«å……æ•°ç»„æ•°æ®
            fillArrayContainer('tags-container', game.tags);
            fillArrayContainer('controls-container', game.controls);
            fillArrayContainer('tips-container', game.tips);
            
            // åˆ‡æ¢åˆ°æ·»åŠ é¢æ¿
            showPanel('add');
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo(0, 0);
            
            // è¿›å…¥ç¼–è¾‘æ¨¡å¼
            enterEditMode(gameId);
        }
        
        // å¡«å……æ•°ç»„å®¹å™¨
        function fillArrayContainer(containerId, data) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            if (data && data.length > 0) {
                data.forEach((item, index) => {
                    const newItem = document.createElement('div');
                    newItem.className = 'array-item';
                    newItem.innerHTML = `
                        <input type="text" class="array-input" value="${item}">
                        <button type="button" class="array-btn" onclick="removeArrayItem(this)">åˆ é™¤</button>
                    `;
                    container.appendChild(newItem);
                });
            } else {
                // è‡³å°‘æ·»åŠ ä¸€ä¸ªç©ºé¡¹ç›®
                addArrayItem(containerId, 'æ ‡ç­¾1');
            }
        }
        
        // åˆ é™¤æ¸¸æˆ
        function deleteGame(gameId) {
            if (confirm(`ç¡®å®šè¦åˆ é™¤æ¸¸æˆ "${gamesData[gameId].title}" å—ï¼Ÿ`)) {
                delete gamesData[gameId];
                saveGamesData();
                loadGamesList();
                showMessage('æ¸¸æˆåˆ é™¤æˆåŠŸï¼', 'success');
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            const totalGames = Object.keys(gamesData).length;
            let totalPlays = 0;
            let totalLikes = 0;
            let totalRating = 0;
            let ratingCount = 0;
            
            const categoryStats = {};
            
            Object.values(gamesData).forEach(game => {
                totalPlays += game.stats.playCount;
                totalLikes += game.stats.likes;
                totalRating += game.stats.rating;
                ratingCount++;
                
                // ç»Ÿè®¡åˆ†ç±»
                if (!categoryStats[game.category]) {
                    categoryStats[game.category] = 0;
                }
                categoryStats[game.category]++;
            });
            
            // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
            document.getElementById('total-games').textContent = totalGames;
            document.getElementById('total-plays').textContent = formatNumber(totalPlays);
            document.getElementById('total-likes').textContent = formatNumber(totalLikes);
            document.getElementById('avg-rating').textContent = ratingCount > 0 ? (totalRating / ratingCount).toFixed(1) : '0';
            
            // æ›´æ–°åˆ†ç±»ç»Ÿè®¡
            const categoryContainer = document.getElementById('category-stats');
            categoryContainer.innerHTML = '';
            
            Object.keys(categoryStats).forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.style.cssText = 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 10px; text-align: center;';
                categoryCard.innerHTML = `
                    <h4 style="font-size: 1.5rem; margin-bottom: 5px;">${categoryStats[category]}</h4>
                    <p style="font-size: 0.9rem;">${category}</p>
                `;
                categoryContainer.appendChild(categoryCard);
            });
        }
        
        // æ ¼å¼åŒ–æ•°å­—
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }
        
        // å¯¼å‡ºæ¸¸æˆæ•°æ®
        function exportGamesData() {
            const dataStr = JSON.stringify(gamesData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'games-data.json';
            link.click();
            URL.revokeObjectURL(url);
        }
        
        // å¯¼å…¥æ¸¸æˆæ•°æ®
        function importGamesData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            gamesData = data;
                            saveGamesData();
                            loadGamesList();
                            updateStats();
                            showMessage('æ¸¸æˆæ•°æ®å¯¼å…¥æˆåŠŸï¼', 'success');
                        } catch (error) {
                            showMessage('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·é€‰æ‹©æœ‰æ•ˆçš„JSONæ–‡ä»¶', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }
        
        // ç”¨æˆ·ç®¡ç†åŠŸèƒ½
        function addUser() {
            const username = document.getElementById('new-username').value.trim();
            const password = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // éªŒè¯è¾“å…¥
            if (!username || !password || !confirmPassword) {
                showUserMessage('è¯·å¡«å†™æ‰€æœ‰å­—æ®µ', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showUserMessage('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´', 'error');
                return;
            }
            
            if (password.length < 6) {
                showUserMessage('å¯†ç é•¿åº¦è‡³å°‘6ä½', 'error');
                return;
            }
            
            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            const admins = getAdmins();
            if (admins.some(admin => admin.username === username)) {
                showUserMessage('ç”¨æˆ·åå·²å­˜åœ¨', 'error');
                return;
            }
            
            // åˆ›å»ºæ–°ç®¡ç†å‘˜
            const newAdmin = {
                username: username,
                password: password,
                role: 'admin',
                created: new Date().toISOString()
            };
            
            // æ·»åŠ åˆ°ç®¡ç†å‘˜åˆ—è¡¨
            admins.push(newAdmin);
            localStorage.setItem('adminUsers', JSON.stringify(admins));
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showUserMessage('ç®¡ç†å‘˜æ·»åŠ æˆåŠŸï¼', 'success');
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('user-form').reset();
            
            // é‡æ–°åŠ è½½ç”¨æˆ·åˆ—è¡¨
            loadUsersList();
        }
        
        // è·å–ç®¡ç†å‘˜åˆ—è¡¨
        function getAdmins() {
            const adminsData = localStorage.getItem('adminUsers');
            return adminsData ? JSON.parse(adminsData) : [];
        }
        
        // åŠ è½½ç”¨æˆ·åˆ—è¡¨
        function loadUsersList() {
            const container = document.getElementById('users-list');
            container.innerHTML = '';
            
            const admins = getAdmins();
            
            admins.forEach(admin => {
                const userItem = document.createElement('div');
                userItem.className = 'game-item';
                userItem.innerHTML = `
                    <div class="game-header">
                        <h3 class="game-title">${admin.username}</h3>
                        <div class="game-actions">
                            <button class="action-btn delete-btn" onclick="deleteUser('${admin.username}')">åˆ é™¤</button>
                        </div>
                    </div>
                    <div class="game-info">
                        <p><strong>è§’è‰²:</strong> ${admin.role}</p>
                        <p><strong>åˆ›å»ºæ—¶é—´:</strong> ${new Date(admin.created).toLocaleString()}</p>
                    </div>
                `;
                container.appendChild(userItem);
            });
        }
        
        // åˆ é™¤ç”¨æˆ·
        function deleteUser(username) {
            if (confirm(`ç¡®å®šè¦åˆ é™¤ç®¡ç†å‘˜ "${username}" å—ï¼Ÿ`)) {
                const admins = getAdmins();
                const filteredAdmins = admins.filter(admin => admin.username !== username);
                localStorage.setItem('adminUsers', JSON.stringify(filteredAdmins));
                loadUsersList();
                showUserMessage('ç®¡ç†å‘˜åˆ é™¤æˆåŠŸï¼', 'success');
            }
        }
        
        // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
        function showUserMessage(message, type) {
            const container = document.getElementById('user-message-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            
            container.innerHTML = '';
            container.appendChild(messageDiv);
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
    </script>
</body>
</html>

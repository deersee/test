<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ê∏∏ÊàèÁÆ°ÁêÜÂêéÂè∞ - Game8.live</title>
    <meta name="description" content="Game8.live Ê∏∏ÊàèÁÆ°ÁêÜÂêéÂè∞Á≥ªÁªü">
    <meta name="author" content="Game8.live">
    
    <link rel="stylesheet" href="styles.css">
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .admin-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .admin-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        
        .admin-nav {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }
        
        .admin-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .admin-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .form-array {
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 15px;
            background: #f8f9fa;
        }
        
        .array-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .array-item:last-child {
            margin-bottom: 0;
        }
        
        .array-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        .array-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .array-btn:hover {
            background: #ee5a24;
        }
        
        .add-array-btn {
            background: #4ecdc4;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
        }
        
        .add-array-btn:hover {
            background: #45b7d1;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .games-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .game-item {
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .game-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .game-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .game-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }
        
        .game-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .edit-btn {
            background: #4ecdc4;
            color: white;
        }
        
        .edit-btn:hover {
            background: #45b7d1;
        }
        
        .delete-btn {
            background: #ff6b6b;
            color: white;
        }
        
        .delete-btn:hover {
            background: #ee5a24;
        }
        
        .game-info {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .game-stats {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            font-size: 0.8rem;
            color: #888;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .admin-content {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .admin-nav {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <a href="index.html" class="back-link">
            ‚Üê ËøîÂõûÈ¶ñÈ°µ
        </a>
        
        <div class="admin-header">
            <h1 class="admin-title">
                üéÆ Ê∏∏ÊàèÁÆ°ÁêÜÂêéÂè∞
            </h1>
            <p class="admin-subtitle">ÁÆ°ÁêÜ Game8.live ÁöÑÊâÄÊúâÊ∏∏ÊàèÂÜÖÂÆπÂíåÊï∞ÊçÆ</p>
            
            <div class="admin-nav">
                <button class="nav-btn active" onclick="showPanel('add')">Ê∑ªÂä†Ê∏∏Êàè</button>
                <button class="nav-btn" onclick="showPanel('manage')">ÁÆ°ÁêÜÊ∏∏Êàè</button>
                <button class="nav-btn" onclick="showPanel('stats')">Êï∞ÊçÆÁªüËÆ°</button>
                <button class="nav-btn" onclick="showPanel('users')">Áî®Êà∑ÁÆ°ÁêÜ</button>
            </div>
        </div>
        
        <div class="admin-content">
            <!-- Ê∑ªÂä†Ê∏∏ÊàèÈù¢Êùø -->
            <div id="add-panel" class="admin-panel">
                <h2 class="panel-title">‚ûï Ê∑ªÂä†Êñ∞Ê∏∏Êàè</h2>
                
                <div id="message-container"></div>
                
                <form id="game-form">
                    <div class="form-group">
                        <label class="form-label">Ê∏∏ÊàèID *</label>
                        <input type="text" id="game-id" class="form-input" placeholder="‰æãÂ¶Ç: newgame" required>
                        <small style="color: #666; font-size: 0.9rem;">Áî®‰∫éURLÂíåÂÜÖÈÉ®Ê†áËØÜÔºåÂè™ËÉΩÂåÖÂê´Â≠óÊØç„ÄÅÊï∞Â≠óÂíå‰∏ãÂàíÁ∫ø</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Ê∏∏ÊàèÂêçÁß∞ *</label>
                        <input type="text" id="game-title" class="form-input" placeholder="‰æãÂ¶Ç: Êñ∞Ê∏∏Êàè" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Ê∏∏ÊàèÊèèËø∞ *</label>
                        <textarea id="game-description" class="form-textarea" placeholder="ËØ¶ÁªÜÊèèËø∞Ê∏∏ÊàèÁé©Ê≥ïÂíåÁâπËâ≤..." required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Ê∏∏ÊàèÂàÜÁ±ª *</label>
                            <select id="game-category" class="form-select" required>
                                <option value="">ÈÄâÊã©ÂàÜÁ±ª</option>
                                <option value="action">Âä®‰ΩúÊ∏∏Êàè</option>
                                <option value="strategy">Á≠ñÁï•Ê∏∏Êàè</option>
                                <option value="puzzle">ÁõäÊô∫Ê∏∏Êàè</option>
                                <option value="racing">Á´ûÈÄüÊ∏∏Êàè</option>
                                <option value="sports">‰ΩìËÇ≤Ê∏∏Êàè</option>
                                <option value="social">Á§æ‰∫§Ê∏∏Êàè</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Ê∏∏ÊàèÂõæÁâáURL *</label>
                            <input type="url" id="game-image" class="form-input" placeholder="https://images.unsplash.com/..." required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Ê∏∏ÊàèÈìæÊé• *</label>
                        <input type="url" id="game-iframe" class="form-input" placeholder="https://example.com/game" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Ê∏∏ÊàèÊ†áÁ≠æ</label>
                        <div class="form-array" id="tags-container">
                            <div class="array-item">
                                <input type="text" class="array-input" placeholder="Ê†áÁ≠æ1">
                                <button type="button" class="array-btn" onclick="removeArrayItem(this)">Âà†Èô§</button>
                            </div>
                        </div>
                        <button type="button" class="add-array-btn" onclick="addArrayItem('tags-container', 'Ê†áÁ≠æ')">Ê∑ªÂä†Ê†áÁ≠æ</button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Êìç‰ΩúËØ¥Êòé</label>
                        <div class="form-array" id="controls-container">
                            <div class="array-item">
                                <input type="text" class="array-input" placeholder="Êìç‰ΩúËØ¥Êòé1">
                                <button type="button" class="array-btn" onclick="removeArrayItem(this)">Âà†Èô§</button>
                            </div>
                        </div>
                        <button type="button" class="add-array-btn" onclick="addArrayItem('controls-container', 'Êìç‰ΩúËØ¥Êòé')">Ê∑ªÂä†Êìç‰ΩúËØ¥Êòé</button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Ê∏∏ÊàèÊäÄÂ∑ß</label>
                        <div class="form-array" id="tips-container">
                            <div class="array-item">
                                <input type="text" class="array-input" placeholder="Ê∏∏ÊàèÊäÄÂ∑ß1">
                                <button type="button" class="array-btn" onclick="removeArrayItem(this)">Âà†Èô§</button>
                            </div>
                        </div>
                        <button type="button" class="add-array-btn" onclick="addArrayItem('tips-container', 'Ê∏∏ÊàèÊäÄÂ∑ß')">Ê∑ªÂä†Ê∏∏ÊàèÊäÄÂ∑ß</button>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Ê∏∏Áé©Ê¨°Êï∞</label>
                            <input type="number" id="play-count" class="form-input" placeholder="100000" min="0">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ÂñúÁà±Â∫¶</label>
                            <input type="number" id="likes" class="form-input" placeholder="5000" min="0">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ËØÑÂàÜ (1-5)</label>
                            <input type="number" id="rating" class="form-input" placeholder="4.5" min="1" max="5" step="0.1">
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn">Ê∑ªÂä†Ê∏∏Êàè</button>
                </form>
            </div>
            
            <!-- ÁÆ°ÁêÜÊ∏∏ÊàèÈù¢Êùø -->
            <div id="manage-panel" class="admin-panel" style="display: none;">
                <h2 class="panel-title">üìã Ê∏∏ÊàèÂàóË°®ÁÆ°ÁêÜ</h2>
                <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px;">
                    <input type="text" id="game-search" class="form-input" placeholder="ÊêúÁ¥¢Ê∏∏ÊàèÂêçÁß∞„ÄÅIDÊàñÊ†áÁ≠æ..." style="flex: 1;">
                    <div style="white-space: nowrap; color: #666;">
                        <span>ÊÄªÊï∞Ôºö</span><strong id="count-total">0</strong>
                        <span style="margin: 0 8px;">|</span>
                        <span>ÂåπÈÖçÔºö</span><strong id="count-filtered">0</strong>
                    </div>
                </div>
                <div class="games-list" id="games-list">
                    <!-- Ê∏∏ÊàèÂàóË°®Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
            
            <!-- Êï∞ÊçÆÁªüËÆ°Èù¢Êùø -->
            <div id="stats-panel" class="admin-panel" style="display: none;">
                <h2 class="panel-title">üìä Êï∞ÊçÆÁªüËÆ°</h2>
                
                <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="total-games">0</h3>
                        <p>ÊÄªÊ∏∏ÊàèÊï∞</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #4ecdc4 0%, #45b7d1 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="total-plays">0</h3>
                        <p>ÊÄªÊ∏∏Áé©Ê¨°Êï∞</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="total-likes">0</h3>
                        <p>ÊÄªÂñúÁà±Â∫¶</p>
                    </div>
                    
                    <div class="stat-card" style="background: linear-gradient(135deg, #96ceb4 0%, #feca57 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                        <h3 style="font-size: 2rem; margin-bottom: 10px;" id="avg-rating">0</h3>
                        <p>Âπ≥ÂùáËØÑÂàÜ</p>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">ÂàÜÁ±ªÁªüËÆ°</h3>
                    <div id="category-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <!-- ÂàÜÁ±ªÁªüËÆ°Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
            
            <!-- Áî®Êà∑ÁÆ°ÁêÜÈù¢Êùø -->
            <div id="users-panel" class="admin-panel" style="display: none;">
                <h2 class="panel-title">üë• Áî®Êà∑ÁÆ°ÁêÜ</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <!-- Ê∑ªÂä†Áî®Êà∑Ë°®Âçï -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: #333;">Ê∑ªÂä†Êñ∞ÁÆ°ÁêÜÂëò</h3>
                        
                        <div id="user-message-container"></div>
                        
                        <form id="user-form">
                            <div class="form-group">
                                <label class="form-label">Áî®Êà∑Âêç *</label>
                                <input type="text" id="new-username" class="form-input" placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑Âêç" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">ÂØÜÁ†Å *</label>
                                <input type="password" id="new-password" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Á°ÆËÆ§ÂØÜÁ†Å *</label>
                                <input type="password" id="confirm-password" class="form-input" placeholder="ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å" required>
                            </div>
                            
                            <button type="submit" class="submit-btn">Ê∑ªÂä†ÁÆ°ÁêÜÂëò</button>
                        </form>
                    </div>
                    
                    <!-- Áî®Êà∑ÂàóË°® -->
                    <div>
                        <h3 style="margin-bottom: 20px; color: #333;">ÁÆ°ÁêÜÂëòÂàóË°®</h3>
                        
                        <div class="games-list" id="users-list" style="max-height: 400px;">
                            <!-- Áî®Êà∑ÂàóË°®Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ê∏∏ÊàèÊï∞ÊçÆÁÆ°ÁêÜ
        let gamesData = {};
        // ÂΩìÂâçÁºñËæë‰∏≠ÁöÑÊ∏∏ÊàèIDÔºånull Ë°®Á§∫Ê∑ªÂä†Ê®°Âºè
        let currentEditingId = null;
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
            if (!checkLoginStatus()) {
                window.location.href = 'admin-login.html';
                return;
            }
            
            loadGamesData();
            loadGamesList();
            initGameSearch();
            updateStats();
            
            // Ë°®ÂçïÊèê‰∫§‰∫ã‰ª∂
            document.getElementById('game-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addGame();
            });
            
            // Áî®Êà∑Ë°®ÂçïÊèê‰∫§‰∫ã‰ª∂
            document.getElementById('user-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addUser();
            });
            
            // Ê∑ªÂä†ÁôªÂá∫ÂäüËÉΩ
            addLogoutButton();
        });

        // ÂàùÂßãÂåñÊêúÁ¥¢ÔºàÂ∏¶Èò≤ÊäñÔºâ
        function initGameSearch() {
            const input = document.getElementById('game-search');
            if (!input) return;
            let timer = null;
            const handler = () => {
                const q = input.value || '';
                loadGamesList(q);
            };
            input.addEventListener('input', () => {
                clearTimeout(timer);
                timer = setTimeout(handler, 200);
            });
        }
        
        // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
        function checkLoginStatus() {
            const loginData = localStorage.getItem('adminLoginData');
            if (!loginData) {
                return false;
            }
            
            try {
                const data = JSON.parse(loginData);
                if (!data.isLoggedIn || data.expires <= Date.now()) {
                    // ÁôªÂΩïÂ∑≤ËøáÊúüÊàñÊó†Êïà
                    localStorage.removeItem('adminLoginData');
                    return false;
                }
                return true;
            } catch (error) {
                localStorage.removeItem('adminLoginData');
                return false;
            }
        }
        
        // Ê∑ªÂä†ÁôªÂá∫ÊåâÈíÆ
        function addLogoutButton() {
            const adminNav = document.querySelector('.admin-nav');
            const logoutBtn = document.createElement('button');
            logoutBtn.className = 'nav-btn';
            logoutBtn.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)';
            logoutBtn.innerHTML = 'üö™ ÁôªÂá∫';
            logoutBtn.onclick = function() {
                if (confirm('Á°ÆÂÆöË¶ÅÁôªÂá∫ÂêóÔºü')) {
                    localStorage.removeItem('adminLoginData');
                    window.location.href = 'admin-login.html';
                }
            };
            adminNav.appendChild(logoutBtn);
        }
        
        // Âä†ËΩΩÊ∏∏ÊàèÊï∞ÊçÆ
        function loadGamesData() {
            // ÂÆö‰πâ2025ÈªòËÆ§Ê∏∏ÊàèÊï∞ÊçÆ
            const defaultGames2025 = {
                    smashkarts: {
                        title: 'Smash Karts',
                        description: 'Â§ö‰∫∫ÂÆûÊó∂Âç°‰∏ÅËΩ¶ÂØπÊàòÔºåÊãæÂèñÈÅìÂÖ∑Âπ∂ÂáªË¥•ÂØπÊâãÔºåÂá≠ÊäÄÂ∑ß‰∏éËøêÊ∞îÁß∞Áéã„ÄÇ',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1502877338535-766e1452684a?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://smashkarts.io/',
                        tags: ['Â§ö‰∫∫', 'ÈÅìÂÖ∑', 'ÂØπÊàò'],
                        controls: ['WASDÈ©æÈ©∂ÔºåÁ©∫Ê†ºÊºÇÁßªÔºåÈº†Ê†á‰ΩøÁî®ÈÅìÂÖ∑'],
                        tips: ['ÂºØÈÅìÂâçÈ¢ÑÊºÇÁßª', 'ÈÅìÂÖ∑ÁïôÁªôÂÖ≥ÈîÆ‰Ωç', 'Ë¥¥ÂÜÖÁ∫øËµ∞‰Ωç'],
                        stats: { playCount: 520000, likes: 46000, rating: 4.4 }
                    },
                    diep: {
                        title: 'Diep.io',
                        description: 'ËøõÂåñ‰Ω†ÁöÑÊàòËΩ¶ÔºåÂà∑ÊÄ™‰∏éÂØπÊàòÂÖºÂÖ∑ÁöÑÂù¶ÂÖãÂ∞ÑÂáª„ÄÇ',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1510798831971-661eb04b3739?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://diep.io/',
                        tags: ['Â∞ÑÂáª', 'ËøõÂåñ', 'ÂØπÊàò'],
                        controls: ['WASDÁßªÂä®ÔºåÈº†Ê†áÂ∞ÑÂáªÔºåEÂçáÁ∫ß'],
                        tips: ['ÂÖàÂ†ÜÁîüÂ≠ò‰∏éËæìÂá∫', '‰∏≠ÊúüÈÄâÂ•ΩÂàÜÊîØ', 'ÁïôÊÑèÈ´òÂàÜÁé©ÂÆ∂'],
                        stats: { playCount: 780000, likes: 69000, rating: 4.3 }
                    },
                    starblast: {
                        title: 'Starblast.io',
                        description: 'Â§™Á©∫ÈááÁüø‰∏éËà∞ËàπÊàòÊñóÔºåÂçáÁ∫ßÈ£ûËàπÂπ∂ÂèÇ‰∏éÈòµËê•Êàò‰∫â„ÄÇ',
                        category: 'strategy',
                        image: 'https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://starblast.io/',
                        tags: ['Â§™Á©∫', 'ÈááÁüø', 'ÊàòÊñó'],
                        controls: ['WASD/ÊñπÂêëÈîÆÈ£ûË°åÔºåÈº†Ê†áÂ∞ÑÂáª'],
                        tips: ['ÂâçÊúüÈááÁüøÁ®≥ÂÅ•ÂçáÁ∫ß', 'Êä±Âõ¢‰ΩúÊàòÊî∂ÁõäÈ´ò', 'ËøΩÂáªÂà´Ë∂äÁïå'],
                        stats: { playCount: 430000, likes: 36000, rating: 4.2 }
                    },
                    mope: {
                        title: 'Mope.io',
                        description: '‰ªéÂ∞èÁîüÁâ©ËøõÂåñÂà∞È°∂Á∫ßÊçïÈ£üËÄÖÔºåÈ£üÁâ©Èìæ‰∏äÁöÑÁîüÂ≠ò‰πãÊàò„ÄÇ',
                        category: 'adventure',
                        image: 'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://mope.io/',
                        tags: ['ËøõÂåñ', 'ÁîüÂ≠ò', 'Ê≤ôÁõí'],
                        controls: ['Èº†Ê†áÁßªÂä®ÔºåÁÇπÂáªÂÜ≤Âà∫'],
                        tips: ['ÂêåËâ≤ÂÆâÂÖ®Ôºå‰∏çÂêåËâ≤Ë∞®ÊÖé', 'Âà©Áî®Âú∞ÂΩ¢', 'ÂêàÁêÜËøõÂåñË∑ØÁ∫ø'],
                        stats: { playCount: 390000, likes: 31000, rating: 4.1 }
                    },
                    taming: {
                        title: 'Taming.io',
                        description: 'È©ØÊúçÂÆ†Áâ©„ÄÅÂª∫ÈÄ†‰∏éÁîüÂ≠òÁöÑÂÉèÁ¥†È£éÊ≤ôÁõíÂØπÊàò„ÄÇ',
                        category: 'strategy',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://taming.io/',
                        tags: ['Ê≤ôÁõí', 'Âª∫ÈÄ†', 'ÂÆ†Áâ©'],
                        controls: ['WASDÁßªÂä®ÔºåÈº†Ê†áÊìç‰ΩúÔºåÊï∞Â≠óÈîÆÂàáÊç¢'],
                        tips: ['ÂÖàÈááÈõÜÂª∫Èò≤Âæ°', 'ÊçïÊçâÂÖãÂà∂Á≥ªÂÆ†Áâ©', 'ÁªìÁõüÊïàÁéáÈ´ò'],
                        stats: { playCount: 270000, likes: 22000, rating: 4.0 }
                    },
                    lolshot: {
                        title: 'LOLShot.io',
                        description: 'Âø´ËäÇÂ•èÂç°ÈÄöFPSÔºåÂ§öÊ®°ÂºèÂØπÊàò‰∏éÊµÅÁïÖÊâãÊÑü„ÄÇ',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://lolshot.io/',
                        tags: ['FPS', 'Â§ö‰∫∫', 'Âø´ËäÇÂ•è'],
                        controls: ['WASDÁßªÂä®ÔºåÈº†Ê†áÂ∞ÑÂáªÔºåRË£ÖÂºπ'],
                        tips: ['Â≠¶‰ºö‰æßË∫´Â≥∞ÂÄºÂ∞ÑÂáª', 'ÊéßÁÇπÊØîÁõ≤ÂÜ≤Êõ¥ÈáçË¶Å', 'ÂñÑÁî®Ë∑≥Âè∞'],
                        stats: { playCount: 310000, likes: 25000, rating: 4.1 }
                    },
                    hexar: {
                        title: 'Hexar.io',
                        description: 'ÂÖ≠ËæπÂΩ¢È¢ÜÂú∞‰∫âÂ§∫ÔºåÂõ¥Á∫øÂ∞ÅÂå∫Âπ∂Êâ©Â§ßÂäøÂäõËåÉÂõ¥„ÄÇ',
                        category: 'strategy',
                        image: 'https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://hexar.io/',
                        tags: ['È¢ÜÂú∞', 'Âõ¥Á∫ø', 'ÂØπÊàò'],
                        controls: ['Èº†Ê†á/Ëß¶ÊéßÁßªÂä®'],
                        tips: ['Â∞èÂúàÂø´Â∞ÅÂè£', 'Âç°ÂØπÊâãÂõûÁ∫ø', '‰ºòÂÖàÁ®≥ÂÆâÂÖ®Ëæπ'],
                        stats: { playCount: 260000, likes: 21000, rating: 4.0 }
                    },
                    powerline: {
                        title: 'Powerline.io',
                        description: 'ÈúìËôπË¥™ÂêÉËõáÂØπÊàòÔºåÂä†ÈÄü‰∏éÂç°‰ΩçÁöÑÈ´òËÉΩÂçöÂºà„ÄÇ',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://powerline.io/',
                        tags: ['Ë¥™ÂêÉËõá', 'ÂØπÊàò', 'Ë°óÊú∫'],
                        controls: ['ÊñπÂêëÈîÆ/WASDÁßªÂä®'],
                        tips: ['ËæπÁ∫øÂç°‰Ωç', 'Âä†ÈÄüËØ±Êïå', 'Á®≥ÂÅ•ÂêÉÊÆãÈ™∏'],
                        stats: { playCount: 300000, likes: 24000, rating: 4.1 }
                    },
                    evio: {
                        title: 'ev.io',
                        description: 'ÁßëÂπªÈ£éÊµèËßàÂô®FPSÔºåËΩªÈáèÊµÅÁïÖÁöÑÁ´ûÊäÄ‰ΩìÈ™å„ÄÇ',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://ev.io/',
                        tags: ['FPS', 'ÁßëÂπª', 'Á´ûÊäÄ'],
                        controls: ['WASDÁßªÂä®ÔºåÈº†Ê†áÂ∞ÑÂáªÔºåÁ©∫Ê†ºË∑≥Ë∑É'],
                        tips: ['Âà©Áî®Ë∑≥ÊùøÊäÑËøëË∑Ø', 'ËøúËøëÊû™Ê¢∞ÂàáÊç¢', 'ÊéßÈ´òÁÇπ‰ºòÂäø'],
                        stats: { playCount: 410000, likes: 35000, rating: 4.2 }
                    },
                    smasharena: {
                        title: 'Smash Arena',
                        description: '‰∏äÂ∏ùËßÜËßíÁöÑÁ´ûÊäÄÊ∑∑ÊàòÔºåÊãæÂèñÊ≠¶Âô®‰∏éÊäÄËÉΩÂø´ÈÄüÂÜ≥Êñó„ÄÇ',
                        category: 'action',
                        image: 'https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://smasharena.io/',
                        tags: ['Â§ö‰∫∫', 'Á´ûÊäÄ', 'ÈÅìÂÖ∑'],
                        controls: ['WASDÁßªÂä®ÔºåÈº†Ê†áÁûÑÂáÜ/ÊñΩÊîæ'],
                        tips: ['ÂÖàÊ¥ªÂÜçÂàö', 'ËßÇÂØüÂúàËæπÂà∑Êñ∞', 'ÊäÄËÉΩËøûÊÆµËá¥ËÉú'],
                        stats: { playCount: 180000, likes: 15000, rating: 4.0 }
                    },
                    mgsdelta: {
                        title: 'Metal Gear Solid Delta: Snake Eater',
                        description: 'ÊΩúÂÖ•‰∏éÁîüÂ≠ò‰∏∫Ê†∏ÂøÉÁöÑÁªèÂÖ∏ÈáçÂà∂ÁâàÂÜÖÂÆπËÅöÂêàÔºöÂÆåÊï¥ÊµÅÁ®ã„ÄÅBoss ÊåáÂçó„ÄÅÊ≠¶Âô®‰∏é‰º™Ë£Ö„ÄÅÊî∂ÈõÜË¶ÅÁ¥†Âèä‰∫íÂä®Âú∞Âõæ„ÄÇ',
                        category: 'adventure',
                        image: 'https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?w=400&h=300&fit=crop&crop=center',
                        iframe: 'https://game8.co/games/Metal-Gear-Solid-Delta-Snake-Eater',
                        tags: ['ÊΩúÂÖ•', 'Âä®‰ΩúÂÜíÈô©', 'ÈáçÂà∂Áâà', 'ÊîªÁï•'],
                        controls: ['ÊåâÂπ≥Âè∞ÈîÆÈº†/ÊâãÊüÑÊìç‰ΩúÔºõ‰ª•ÊΩúÂÖ•‰∏éCQC‰∏∫Ê†∏ÂøÉ'],
                        tips: ['‰ºòÂÖàÊΩúË°åÈôçË≠¶Êàí', 'ÁÅµÊ¥ªÊõ¥Êç¢‰º™Ë£Ö', 'BossÊàòÂâçË°•Áªô‰∏éÂ≠òÊ°£', 'ÂñÑÁî®‰∫íÂä®Âú∞Âõæ‰∏éÊî∂ÈõÜÊ∏ÖÂçï'],
                        stats: { playCount: 120000, likes: 9000, rating: 4.6 }
                    }
                };

            // ‰ªélocalStorageÂä†ËΩΩÊï∞ÊçÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÊàñËøáÂ∞ëÂàô‰ΩøÁî®ÈªòËÆ§Êï∞ÊçÆ
            const savedData = localStorage.getItem('adminGamesData');
            if (savedData) {
                try {
                    const parsed = JSON.parse(savedData);
                    const count = parsed && typeof parsed === 'object' ? Object.keys(parsed).length : 0;
                    if (count >= 10) {
                        gamesData = parsed;
                    } else {
                        gamesData = defaultGames2025;
                        saveGamesData();
                    }
                } catch (e) {
                    gamesData = defaultGames2025;
                    saveGamesData();
                }
            } else {
                gamesData = defaultGames2025;
                saveGamesData();
            }
        }
        
        // ‰øùÂ≠òÊ∏∏ÊàèÊï∞ÊçÆ
        function saveGamesData() {
            localStorage.setItem('adminGamesData', JSON.stringify(gamesData));
        }
        
        // ÊòæÁ§∫Èù¢Êùø
        function showPanel(panelName) {
            // ÈöêËóèÊâÄÊúâÈù¢Êùø
            document.querySelectorAll('.admin-panel').forEach(panel => {
                panel.style.display = 'none';
            });
            
            // ÁßªÈô§ÊâÄÊúâÊåâÈíÆÁöÑactiveÁ±ª
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÈù¢Êùø
            document.getElementById(panelName + '-panel').style.display = 'block';
            
            // Ê∑ªÂä†activeÁ±ªÂà∞ÂØπÂ∫îÊåâÈíÆ
            event.target.classList.add('active');
            
            // Â¶ÇÊûúÊòØÁÆ°ÁêÜÈù¢ÊùøÔºåÈáçÊñ∞Âä†ËΩΩÊ∏∏ÊàèÂàóË°®
            if (panelName === 'manage') {
                loadGamesList();
            }
            
            // Â¶ÇÊûúÊòØÁªüËÆ°Èù¢ÊùøÔºåÊõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
            if (panelName === 'stats') {
                updateStats();
            }
            
            // Â¶ÇÊûúÊòØÁî®Êà∑ÁÆ°ÁêÜÈù¢ÊùøÔºåÂä†ËΩΩÁî®Êà∑ÂàóË°®
            if (panelName === 'users') {
                loadUsersList();
            }

            // Ëã•ËøõÂÖ•Ê∑ªÂä†Èù¢Êùø‰∏îÈùû‰ªéÁºñËæëÊåâÈíÆËß¶ÂèëÔºåÈÄÄÂá∫ÁºñËæëÊ®°ÂºèÔºà‰øùÁïôË°®ÂçïÂÜÖÂÆπÔºâ
            if (panelName === 'add') {
                try {
                    const trigger = event && event.target;
                    if (!trigger || !trigger.classList || !trigger.classList.contains('edit-btn')) {
                        exitEditMode(false);
                    }
                } catch (_) {
                    exitEditMode(false);
                }
            }
        }

        // ËøõÂÖ•ÁºñËæëÊ®°Âºè
        function enterEditMode(gameId) {
            currentEditingId = gameId;
            const submitBtn = document.querySelector('#game-form .submit-btn');
            if (submitBtn) submitBtn.textContent = '‰øùÂ≠ò‰øÆÊîπ';
        }

        // ÈÄÄÂá∫ÁºñËæëÊ®°Âºè
        function exitEditMode(clearForm = true) {
            currentEditingId = null;
            const submitBtn = document.querySelector('#game-form .submit-btn');
            if (submitBtn) submitBtn.textContent = 'Ê∑ªÂä†Ê∏∏Êàè';
            if (clearForm) {
                document.getElementById('game-form').reset();
                resetArrayContainer('tags-container');
                resetArrayContainer('controls-container');
                resetArrayContainer('tips-container');
            }
        }
        
        // Ê∑ªÂä†Êàñ‰øùÂ≠òÊ∏∏Êàè
        function addGame() {
            const gameId = document.getElementById('game-id').value.trim();
            const title = document.getElementById('game-title').value.trim();
            const description = document.getElementById('game-description').value.trim();
            const category = document.getElementById('game-category').value;
            const image = document.getElementById('game-image').value.trim();
            const iframe = document.getElementById('game-iframe').value.trim();
            
            // È™åËØÅÂøÖÂ°´Â≠óÊÆµ
            if (!gameId || !title || !description || !category || !image || !iframe) {
                showMessage('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ', 'error');
                return;
            }
            
            // È™åËØÅÊ∏∏ÊàèIDÊ†ºÂºè
            if (!/^[a-zA-Z0-9_]+$/.test(gameId)) {
                showMessage('Ê∏∏ÊàèIDÂè™ËÉΩÂåÖÂê´Â≠óÊØç„ÄÅÊï∞Â≠óÂíå‰∏ãÂàíÁ∫ø', 'error');
                return;
            }
            
            // Êñ∞Âª∫/ÁºñËæëÊ†°È™å
            if (currentEditingId === null) {
                if (gamesData[gameId]) {
                    showMessage('Ê∏∏ÊàèIDÂ∑≤Â≠òÂú®ÔºåËØ∑‰ΩøÁî®ÂÖ∂‰ªñID', 'error');
                    return;
                }
            } else {
                if (gameId !== currentEditingId && gamesData[gameId]) {
                    showMessage('Êñ∞ÁöÑÊ∏∏ÊàèIDÂ∑≤Â≠òÂú®ÔºåËØ∑Êõ¥Êç¢IDÊàñ‰øùÊåÅ‰∏çÂèò', 'error');
                    return;
                }
            }
            
            // Êî∂ÈõÜÊï∞ÁªÑÊï∞ÊçÆ
            const tags = getArrayData('tags-container');
            const controls = getArrayData('controls-container');
            const tips = getArrayData('tips-container');
            
            // Ëé∑ÂèñÁªüËÆ°Êï∞ÊçÆ
            const playCount = parseInt(document.getElementById('play-count').value) || 0;
            const likes = parseInt(document.getElementById('likes').value) || 0;
            const rating = parseFloat(document.getElementById('rating').value) || 4.0;
            
            // ÂàõÂª∫Ê∏∏ÊàèÂØπË±°
            const newGame = {
                title: title,
                description: description,
                category: category,
                image: image,
                iframe: iframe,
                tags: tags,
                controls: controls,
                tips: tips,
                stats: {
                    playCount: playCount,
                    likes: likes,
                    rating: rating
                }
            };
            
            // ÂÜôÂÖ•Âà∞Ê∏∏ÊàèÊï∞ÊçÆ
            if (currentEditingId === null) {
                gamesData[gameId] = newGame;
            } else {
                if (gameId !== currentEditingId) {
                    delete gamesData[currentEditingId];
                }
                gamesData[gameId] = newGame;
            }
            saveGamesData();
            
            // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
            showMessage(currentEditingId === null ? 'Ê∏∏ÊàèÊ∑ªÂä†ÊàêÂäüÔºÅ' : '‰øùÂ≠ò‰øÆÊîπÊàêÂäüÔºÅ', 'success');
            
            // Ê∏ÖÁ©∫Ë°®ÂçïÂπ∂ÈÄÄÂá∫ÁºñËæëÊ®°Âºè
            document.getElementById('game-form').reset();
            exitEditMode();
            
            // ÈáçÁΩÆÊï∞ÁªÑÂÆπÂô®
            resetArrayContainer('tags-container');
            resetArrayContainer('controls-container');
            resetArrayContainer('tips-container');
            loadGamesList();
        }
        
        // Ëé∑ÂèñÊï∞ÁªÑÊï∞ÊçÆ
        function getArrayData(containerId) {
            const container = document.getElementById(containerId);
            const inputs = container.querySelectorAll('.array-input');
            const data = [];
            
            inputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    data.push(value);
                }
            });
            
            return data;
        }
        
        // Ê∑ªÂä†Êï∞ÁªÑÈ°π
        function addArrayItem(containerId, placeholder) {
            const container = document.getElementById(containerId);
            const newItem = document.createElement('div');
            newItem.className = 'array-item';
            newItem.innerHTML = `
                <input type="text" class="array-input" placeholder="${placeholder}">
                <button type="button" class="array-btn" onclick="removeArrayItem(this)">Âà†Èô§</button>
            `;
            container.appendChild(newItem);
        }
        
        // Âà†Èô§Êï∞ÁªÑÈ°π
        function removeArrayItem(button) {
            const container = button.parentElement.parentElement;
            const items = container.querySelectorAll('.array-item');
            
            // Ëá≥Â∞ë‰øùÁïô‰∏Ä‰∏™È°πÁõÆ
            if (items.length > 1) {
                button.parentElement.remove();
            }
        }
        
        // ÈáçÁΩÆÊï∞ÁªÑÂÆπÂô®
        function resetArrayContainer(containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="array-item">
                    <input type="text" class="array-input" placeholder="Ê†áÁ≠æ1">
                    <button type="button" class="array-btn" onclick="removeArrayItem(this)">Âà†Èô§</button>
                </div>
            `;
        }
        
        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(message, type) {
            const container = document.getElementById('message-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            
            container.innerHTML = '';
            container.appendChild(messageDiv);
            
            // 3ÁßíÂêéËá™Âä®ÈöêËóè
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
        
        // Âä†ËΩΩÊ∏∏ÊàèÂàóË°®
        function loadGamesList(filter = '') {
            const container = document.getElementById('games-list');
            const totalEl = document.getElementById('count-total');
            const filteredEl = document.getElementById('count-filtered');
            container.innerHTML = '';

            const allIds = Object.keys(gamesData);
            const norm = (s) => (s || '').toString().toLowerCase();
            const q = norm(filter);
            const filteredIds = allIds.filter(id => {
                if (!q) return true;
                const g = gamesData[id];
                return (
                    norm(id).includes(q) ||
                    norm(g.title).includes(q) ||
                    norm(g.category).includes(q) ||
                    (g.tags || []).some(t => norm(t).includes(q))
                );
            });

            filteredIds.forEach(gameId => {
                const game = gamesData[gameId];
                const gameItem = document.createElement('div');
                gameItem.className = 'game-item';
                gameItem.style.display = 'grid';
                gameItem.style.gridTemplateColumns = '120px 1fr auto';
                gameItem.style.gap = '15px';

                const thumb = document.createElement('div');
                thumb.style.width = '120px';
                thumb.style.height = '80px';
                thumb.style.overflow = 'hidden';
                thumb.style.borderRadius = '10px';
                thumb.innerHTML = `<img src="${game.image || ''}" alt="${game.title}" style="width:100%;height:100%;object-fit:cover;">`;

                const info = document.createElement('div');
                info.innerHTML = `
                    <div class="game-header" style="margin-bottom: 6px;">
                        <h3 class="game-title" style="margin:0;">${game.title}</h3>
                    </div>
                    <div class="game-info">
                        <p><strong>ID:</strong> ${gameId}„ÄÄ<strong>ÂàÜÁ±ª:</strong> ${game.category}</p>
                        <p style="margin-top:4px;color:#666;">${game.description.substring(0, 120)}${game.description.length > 120 ? '...' : ''}</p>
                        <div class="game-stats" style="margin-top:8px;">
                            <div class="stat-item"><span>üéÆ</span><span>${formatNumber(game.stats.playCount)}Ê¨°</span></div>
                            <div class="stat-item"><span>‚ù§Ô∏è</span><span>${formatNumber(game.stats.likes)}</span></div>
                            <div class="stat-item"><span>‚≠ê</span><span>${game.stats.rating}</span></div>
                        </div>
                    </div>
                `;

                const actions = document.createElement('div');
                actions.className = 'game-actions';
                actions.innerHTML = `
                    <button class="action-btn edit-btn" onclick="editGame('${gameId}')">ÁºñËæë</button>
                    <button class="action-btn delete-btn" onclick="deleteGame('${gameId}')">Âà†Èô§</button>
                `;

                gameItem.appendChild(thumb);
                gameItem.appendChild(info);
                gameItem.appendChild(actions);
                container.appendChild(gameItem);
            });

            if (totalEl) totalEl.textContent = allIds.length;
            if (filteredEl) filteredEl.textContent = filteredIds.length;
        }
        
        // ÁºñËæëÊ∏∏Êàè
        function editGame(gameId) {
            const game = gamesData[gameId];
            
            // Â°´ÂÖÖË°®Âçï
            document.getElementById('game-id').value = gameId;
            document.getElementById('game-title').value = game.title;
            document.getElementById('game-description').value = game.description;
            document.getElementById('game-category').value = game.category;
            document.getElementById('game-image').value = game.image;
            document.getElementById('game-iframe').value = game.iframe;
            document.getElementById('play-count').value = game.stats.playCount;
            document.getElementById('likes').value = game.stats.likes;
            document.getElementById('rating').value = game.stats.rating;
            
            // Â°´ÂÖÖÊï∞ÁªÑÊï∞ÊçÆ
            fillArrayContainer('tags-container', game.tags);
            fillArrayContainer('controls-container', game.controls);
            fillArrayContainer('tips-container', game.tips);
            
            // ÂàáÊç¢Âà∞Ê∑ªÂä†Èù¢Êùø
            showPanel('add');
            
            // ÊªöÂä®Âà∞È°∂ÈÉ®
            window.scrollTo(0, 0);
            
            // ËøõÂÖ•ÁºñËæëÊ®°Âºè
            enterEditMode(gameId);
        }
        
        // Â°´ÂÖÖÊï∞ÁªÑÂÆπÂô®
        function fillArrayContainer(containerId, data) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            if (data && data.length > 0) {
                data.forEach((item, index) => {
                    const newItem = document.createElement('div');
                    newItem.className = 'array-item';
                    newItem.innerHTML = `
                        <input type="text" class="array-input" value="${item}">
                        <button type="button" class="array-btn" onclick="removeArrayItem(this)">Âà†Èô§</button>
                    `;
                    container.appendChild(newItem);
                });
            } else {
                // Ëá≥Â∞ëÊ∑ªÂä†‰∏Ä‰∏™Á©∫È°πÁõÆ
                addArrayItem(containerId, 'Ê†áÁ≠æ1');
            }
        }
        
        // Âà†Èô§Ê∏∏Êàè
        function deleteGame(gameId) {
            if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Ê∏∏Êàè "${gamesData[gameId].title}" ÂêóÔºü`)) {
                delete gamesData[gameId];
                saveGamesData();
                loadGamesList();
                showMessage('Ê∏∏ÊàèÂà†Èô§ÊàêÂäüÔºÅ', 'success');
            }
        }
        
        // Êõ¥Êñ∞ÁªüËÆ°Êï∞ÊçÆ
        function updateStats() {
            const totalGames = Object.keys(gamesData).length;
            let totalPlays = 0;
            let totalLikes = 0;
            let totalRating = 0;
            let ratingCount = 0;
            
            const categoryStats = {};
            
            Object.values(gamesData).forEach(game => {
                totalPlays += game.stats.playCount;
                totalLikes += game.stats.likes;
                totalRating += game.stats.rating;
                ratingCount++;
                
                // ÁªüËÆ°ÂàÜÁ±ª
                if (!categoryStats[game.category]) {
                    categoryStats[game.category] = 0;
                }
                categoryStats[game.category]++;
            });
            
            // Êõ¥Êñ∞ÁªüËÆ°ÊòæÁ§∫
            document.getElementById('total-games').textContent = totalGames;
            document.getElementById('total-plays').textContent = formatNumber(totalPlays);
            document.getElementById('total-likes').textContent = formatNumber(totalLikes);
            document.getElementById('avg-rating').textContent = ratingCount > 0 ? (totalRating / ratingCount).toFixed(1) : '0';
            
            // Êõ¥Êñ∞ÂàÜÁ±ªÁªüËÆ°
            const categoryContainer = document.getElementById('category-stats');
            categoryContainer.innerHTML = '';
            
            Object.keys(categoryStats).forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.style.cssText = 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 10px; text-align: center;';
                categoryCard.innerHTML = `
                    <h4 style="font-size: 1.5rem; margin-bottom: 5px;">${categoryStats[category]}</h4>
                    <p style="font-size: 0.9rem;">${category}</p>
                `;
                categoryContainer.appendChild(categoryCard);
            });
        }
        
        // Ê†ºÂºèÂåñÊï∞Â≠ó
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }
        
        // ÂØºÂá∫Ê∏∏ÊàèÊï∞ÊçÆ
        function exportGamesData() {
            const dataStr = JSON.stringify(gamesData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'games-data.json';
            link.click();
            URL.revokeObjectURL(url);
        }
        
        // ÂØºÂÖ•Ê∏∏ÊàèÊï∞ÊçÆ
        function importGamesData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            gamesData = data;
                            saveGamesData();
                            loadGamesList();
                            updateStats();
                            showMessage('Ê∏∏ÊàèÊï∞ÊçÆÂØºÂÖ•ÊàêÂäüÔºÅ', 'success');
                        } catch (error) {
                            showMessage('Êñá‰ª∂Ê†ºÂºèÈîôËØØÔºåËØ∑ÈÄâÊã©ÊúâÊïàÁöÑJSONÊñá‰ª∂', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }
        
        // Áî®Êà∑ÁÆ°ÁêÜÂäüËÉΩ
        function addUser() {
            const username = document.getElementById('new-username').value.trim();
            const password = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // È™åËØÅËæìÂÖ•
            if (!username || !password || !confirmPassword) {
                showUserMessage('ËØ∑Â°´ÂÜôÊâÄÊúâÂ≠óÊÆµ', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showUserMessage('‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥', 'error');
                return;
            }
            
            if (password.length < 6) {
                showUserMessage('ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë6‰Ωç', 'error');
                return;
            }
            
            // Ê£ÄÊü•Áî®Êà∑ÂêçÊòØÂê¶Â∑≤Â≠òÂú®
            const admins = getAdmins();
            if (admins.some(admin => admin.username === username)) {
                showUserMessage('Áî®Êà∑ÂêçÂ∑≤Â≠òÂú®', 'error');
                return;
            }
            
            // ÂàõÂª∫Êñ∞ÁÆ°ÁêÜÂëò
            const newAdmin = {
                username: username,
                password: password,
                role: 'admin',
                created: new Date().toISOString()
            };
            
            // Ê∑ªÂä†Âà∞ÁÆ°ÁêÜÂëòÂàóË°®
            admins.push(newAdmin);
            localStorage.setItem('adminUsers', JSON.stringify(admins));
            
            // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
            showUserMessage('ÁÆ°ÁêÜÂëòÊ∑ªÂä†ÊàêÂäüÔºÅ', 'success');
            
            // Ê∏ÖÁ©∫Ë°®Âçï
            document.getElementById('user-form').reset();
            
            // ÈáçÊñ∞Âä†ËΩΩÁî®Êà∑ÂàóË°®
            loadUsersList();
        }
        
        // Ëé∑ÂèñÁÆ°ÁêÜÂëòÂàóË°®
        function getAdmins() {
            const adminsData = localStorage.getItem('adminUsers');
            return adminsData ? JSON.parse(adminsData) : [];
        }
        
        // Âä†ËΩΩÁî®Êà∑ÂàóË°®
        function loadUsersList() {
            const container = document.getElementById('users-list');
            container.innerHTML = '';
            
            const admins = getAdmins();
            
            admins.forEach(admin => {
                const userItem = document.createElement('div');
                userItem.className = 'game-item';
                userItem.innerHTML = `
                    <div class="game-header">
                        <h3 class="game-title">${admin.username}</h3>
                        <div class="game-actions">
                            <button class="action-btn delete-btn" onclick="deleteUser('${admin.username}')">Âà†Èô§</button>
                        </div>
                    </div>
                    <div class="game-info">
                        <p><strong>ËßíËâ≤:</strong> ${admin.role}</p>
                        <p><strong>ÂàõÂª∫Êó∂Èó¥:</strong> ${new Date(admin.created).toLocaleString()}</p>
                    </div>
                `;
                container.appendChild(userItem);
            });
        }
        
        // Âà†Èô§Áî®Êà∑
        function deleteUser(username) {
            if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§ÁÆ°ÁêÜÂëò "${username}" ÂêóÔºü`)) {
                const admins = getAdmins();
                const filteredAdmins = admins.filter(admin => admin.username !== username);
                localStorage.setItem('adminUsers', JSON.stringify(filteredAdmins));
                loadUsersList();
                showUserMessage('ÁÆ°ÁêÜÂëòÂà†Èô§ÊàêÂäüÔºÅ', 'success');
            }
        }
        
        // ÊòæÁ§∫Áî®Êà∑Ê∂àÊÅØ
        function showUserMessage(message, type) {
            const container = document.getElementById('user-message-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            
            container.innerHTML = '';
            container.appendChild(messageDiv);
            
            // 3ÁßíÂêéËá™Âä®ÈöêËóè
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
    </script>
</body>
</html>
